<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>checkpointing: brms • chkptstanr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="checkpointing: brms">
<meta property="og:description" content="chkptstanr">
<meta property="og:image" content="https://venpopov.github.io/chkptstanr/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chkptstanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/venpopov/chkptstanr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>checkpointing: brms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/venpopov/chkptstanr/blob/HEAD/vignettes/chkpt_brms.Rmd" class="external-link"><code>vignettes/chkpt_brms.Rmd</code></a></small>
      <div class="hidden name"><code>chkpt_brms.Rmd</code></div>

    </div>

    
    
<p>The following examples walk through using <strong>chkptstanr</strong>
with the popular <code>R</code> package <a href="https://paul-buerkner.github.io/brms/" class="external-link"><strong>brms</strong></a>.</p>
<p>The basic idea is to (1) generate the <a href="https://mc-stan.org/users/interfaces/rstan" class="external-link"><strong>Stan</strong></a>
code with <strong>brms</strong>, (2) fit the model with <a href="https://mc-stan.org/cmdstanr/" class="external-link"><strong>cmdstanr</strong></a> (with
the desired number of checkpoints), and then (3) return a
<code>brmsfit</code> object. This is all done internally, so the
workflow is very similar to using <strong>brms</strong>.</p>
<div class="section level3">
<h3 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/venpopov/chkptstanr" class="external-link">chkptstanr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-1-no-stopping">Example 1: No Stopping<a class="anchor" aria-label="anchor" href="#example-1-no-stopping"></a>
</h2>
<div class="section level3">
<h3 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>You can use chkpt_brms in nearly the same way as brm. The only
difference is that you need to specify the path to the folder where the
checkpoints will be stored, and the number of iterations between each
checkpoint.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span><span class="op">)</span></span></code></pre></div>
<p>When running the above, a custom progress bar is printed that
includes information about the checkpoints.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&gt; Initial Warmup (Typical Set)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Chkpt: 1 / 10; Iteration: 200 / 2000 (warmup)</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Chkpt: 2 / 10; Iteration: 400 / 2000 (warmup)</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Chkpt: 3 / 10; Iteration: 600 / 2000 (warmup)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Chkpt: 4 / 10; Iteration: 800 / 2000 (warmup)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Chkpt: 5 / 10; Iteration: 1000 / 2000 (warmup)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Chkpt: 6 / 10; Iteration: 1200 / 2000 (sample)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Chkpt: 7 / 10; Iteration: 1400 / 2000 (sample)</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Chkpt: 8 / 10; Iteration: 1600 / 2000 (sample)</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Chkpt: 9 / 10; Iteration: 1800 / 2000 (sample)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Chkpt: 10 / 10; Iteration: 2000 / 2000 (sample)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>Checkpointing complete</span></code></pre></div>
<p>In this case, checkpointing is complete.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p><code>fit1</code> is a <code>brmsfit</code> object which means that
all of the functionality of <strong>brms</strong> can still be used.</p>
<p>Here is the summary output:</p>
<pre><code> Family: poisson 
  Links: mu = log 
Formula: count ~ zAge + zBase * Trt + (1 | patient) 
   Data: data (Number of observations: 236) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~patient (Number of levels: 59) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.58      0.07     0.45     0.73 1.00      956     1696

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      1.77      0.12     1.53     2.00 1.00      887     1575
zAge           0.10      0.09    -0.07     0.26 1.00      871     1256
zBase          0.70      0.12     0.47     0.94 1.00      986     1675
Trt1          -0.26      0.16    -0.60     0.05 1.01      987     1170
zBase:Trt1     0.05      0.16    -0.26     0.37 1.00     1075     1824

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="section level3">
<h3 id="posterior-predictive-check">Posterior Predictive Check<a class="anchor" aria-label="anchor" href="#posterior-predictive-check"></a>
</h3>
<p>Of course, due to being a <code>brmsfit</code> object, it is seamless
perform a posterior predictive check.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html" class="external-link">pp_check</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/pp_check_f1.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-2-stoping-restarting-and-resetting">Example 2: Stoping, restarting, and resetting<a class="anchor" aria-label="anchor" href="#example-2-stoping-restarting-and-resetting"></a>
</h2>
<p>We can interupt the sampling manually:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Initial Warmup (Typical Set)</span></span>
<span><span class="co">#&gt; Chkpt: 1 / 10; Iteration: 200 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 2 / 10; Iteration: 400 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 3 / 10; Iteration: 600 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 4 / 10; Iteration: 800 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 5 / 10; Iteration: 1000 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 6 / 10; Iteration: 1200 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Sampling aborted. You can examine the results or continue sampling by rerunning the same code.</span></span></code></pre></div>
<p>If the sampler is passed the warmup stage, it returns a
<code>brmsfit</code> object, so you can examine the results:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: poisson 
  Links: mu = log 
Formula: count ~ zAge + zBase * Trt + (1 | patient) 
   Data: data (Number of observations: 236) 
  Draws: 4 chains, each with iter = 1200; warmup = 1000; thin = 1;
         total post-warmup draws = 800

Multilevel Hyperparameters:
~patient (Number of levels: 59) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.57      0.07     0.45     0.72 1.02      209      236

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      1.75      0.11     1.52     1.98 1.02      206      371
zAge           0.10      0.08    -0.07     0.25 1.02      240      443
zBase          0.70      0.11     0.47     0.95 1.00      220      370
Trt1          -0.24      0.16    -0.56     0.07 1.02      199      239
zBase:Trt1     0.05      0.15    -0.26     0.35 1.00      243      350

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We see that the model has not converged, and we can continue sampling
by rerunning the same code.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; Model executable is up to date!</span></span>
<span><span class="co">#&gt; Chkpt: 7 / 10; Iteration: 1400 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Chkpt: 8 / 10; Iteration: 1600 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Chkpt: 9 / 10; Iteration: 1800 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Chkpt: 10 / 10; Iteration: 2000 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Checkpointing complete</span></span></code></pre></div>
<p>And examine the final results:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code>Family: poisson 
  Links: mu = log 
Formula: count ~ zAge + zBase * Trt + (1 | patient) 
   Data: data (Number of observations: 236) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~patient (Number of levels: 59) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.58      0.07     0.45     0.73 1.00      956     1696

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      1.77      0.12     1.53     2.00 1.00      887     1575
zAge           0.10      0.09    -0.07     0.26 1.00      871     1256
zBase          0.70      0.12     0.47     0.94 1.00      986     1675
Trt1          -0.26      0.16    -0.60     0.05 1.01      987     1170
zBase:Trt1     0.05      0.16    -0.26     0.37 1.00     1075     1824</code></pre>
<div class="section level4">
<h4 id="predetermine-stopping-point">Predetermine stopping point<a class="anchor" aria-label="anchor" href="#predetermine-stopping-point"></a>
</h4>
<p>In addition to manually aborting the run, we can predetermine the
stopping point by specifying the number of iterations after which to
stop the sampler via the <code>stop_after</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   stop_after <span class="op">=</span> <span class="fl">1400</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Initial Warmup (Typical Set)</span></span>
<span><span class="co">#&gt; Chkpt: 1 / 10; Iteration: 200 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 2 / 10; Iteration: 400 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 3 / 10; Iteration: 600 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 4 / 10; Iteration: 800 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 5 / 10; Iteration: 1000 / 2000 (warmup)</span></span>
<span><span class="co">#&gt; Chkpt: 6 / 10; Iteration: 1200 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Chkpt: 7 / 10; Iteration: 1400 / 2000 (sample)</span></span>
<span><span class="co">#&gt; Sampling aborted. You can examine the results or continue sampling by rerunning the same code.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reset-sampling">Reset sampling<a class="anchor" aria-label="anchor" href="#reset-sampling"></a>
</h4>
<p>If we want to reset the sampling, we can use the <code>reset</code>
argument, as long as we have not changed any of the key arguments. For
example, we can reset the sampling and start from scratch, but we cannot
change the formula, data, or family (but we can change “stop_after”)</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span>,</span>
<span>                   stop_after <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>                   reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If we try to change the formula, data, or family, we will get an
error:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chkpt_brms.html">chkpt_brms</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">epilepsy</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   iter_per_chkpt <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                   path <span class="op">=</span> <span class="st">'checkpoints/epilepsy'</span>,</span>
<span>                   stop_after <span class="op">=</span> <span class="fl">1600</span>,</span>
<span>                   reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Error: Important arguments have been changed. Please completely reset the checkpointing via reset_checkpoints(path, recompile = TRUE).
Interupted before or during warmup. No samples available.</code></pre>
<p>This is because we cannot use the existing compiled model. We need to
reset the checkpoints and recompile the model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reset_checkpoints.html">reset_checkpoints</a></span><span class="op">(</span><span class="st">'checkpoints/epilepsy'</span>, recompile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vencislav Popov, Donald Williams, Tyler Matta.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
